---
// Definir el tipo Command localmente para compatibilidad con datos de Notion
interface Command {
  id: string;
  title: string;
  command: string;
  description: string;
  category: string;
  tags: string[];
  examples?: string[];
  dangerous?: boolean;
  platform?: string;
  syntax?: string;
  parameters?: Array<{
    param: string;
    description: string;
    example: string;
  }>;
  output?: string;
  notes?: string;
  references?: string[];
  created_at: string;
  updated_at: string;
}
import Card from '../ui/Card.astro';
import Badge from '../ui/Badge.astro';

interface Props {
  command: Command;
  isSelected?: boolean;
  onClick?: string;
}

const { command, isSelected = false, onClick } = Astro.props;

// Función para asignar colores a categorías
function getCategoryColor(category: string): string {
  const colorMap: { [key: string]: string } = {
    'cifrado': 'purple',
    'Cifrado': 'purple',
    'escan': 'blue',
    'Escan': 'blue',
    'linux': 'green',
    'Linux': 'green',
    'python': 'green',
    'Python': 'green',
    'config': 'indigo',
    'Config': 'indigo',
    'all': 'gray'
  };
  
  return colorMap[category] || 'blue';
}

const categoryColor = getCategoryColor(command.category);

// Generar el slug del comando
const slug = command.title.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
---

<div class="command-card cursor-pointer transition-transform hover:scale-[1.02] active:scale-[0.98]" onclick={onClick}>
  <Card className={`p-4 sm:p-6 ${isSelected ? 'ring-2 ring-blue-500' : ''} hover:shadow-lg transition-shadow`}>
    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4">
      <div class="flex items-center flex-1 min-w-0 gap-3">
        <div class="flex-1 min-w-0">
          <h3 class={`text-lg sm:text-xl font-mono font-semibold text-${categoryColor}-700 dark:text-${categoryColor}-400 truncate`}>
            {command.title}
          </h3>
        </div>
        {command.dangerous && 
          <span class="bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 text-xs font-bold px-2 py-1 rounded-full flex-shrink-0">⚠️</span>
        }
        <a 
          href={`/comando/${slug}`}
          onclick="event.stopPropagation()"
          class="flex-shrink-0 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors p-2 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg"
          title="Ver página completa"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
          </svg>
        </a>
      </div>
      <div class="flex-shrink-0 w-full sm:w-auto">
        <code class="font-mono text-xs sm:text-sm text-gray-700 dark:text-gray-200 bg-gray-50 dark:bg-gray-800 px-3 py-2 rounded-md break-all border border-gray-200 dark:border-gray-600 block w-full sm:w-auto hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
          {command.syntax || command.command}
        </code>
      </div>
    </div>
  </Card>
</div>
